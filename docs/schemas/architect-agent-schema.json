{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://multi-agent-system/architect-agent",
  "title": "Architect Agent Schema",
  "description": "Schema for Architecture Design Agent following Anthropic patterns",
  "version": "1.0.0",
  
  "type": "object",
  
  "properties": {
    "request": {
      "type": "object",
      "required": ["requirements", "context"],
      "properties": {
        "requirements": {
          "type": "object",
          "required": ["functional", "non_functional"],
          "properties": {
            "functional": {
              "type": "array",
              "minItems": 1,
              "items": {
                "type": "object",
                "required": ["id", "description", "priority"],
                "properties": {
                  "id": {"type": "string"},
                  "description": {"type": "string"},
                  "priority": {
                    "type": "string",
                    "enum": ["critical", "high", "medium", "low"]
                  },
                  "acceptance_criteria": {
                    "type": "array",
                    "items": {"type": "string"}
                  }
                }
              }
            },
            "non_functional": {
              "type": "array",
              "items": {
                "type": "object",
                "required": ["category", "requirement", "metric"],
                "properties": {
                  "category": {
                    "type": "string",
                    "enum": ["performance", "security", "scalability", "reliability", "usability", "maintainability"]
                  },
                  "requirement": {"type": "string"},
                  "metric": {"type": "string"},
                  "target_value": {"type": "string"}
                }
              }
            },
            "constraints": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "type": {
                    "type": "string",
                    "enum": ["technical", "business", "regulatory", "resource"]
                  },
                  "description": {"type": "string"},
                  "impact": {
                    "type": "string",
                    "enum": ["blocker", "major", "minor"]
                  }
                }
              }
            }
          }
        },
        "context": {
          "type": "object",
          "properties": {
            "tech_stack": {
              "type": "object",
              "properties": {
                "preferred": {
                  "type": "array",
                  "items": {"type": "string"}
                },
                "avoided": {
                  "type": "array",
                  "items": {"type": "string"}
                },
                "existing": {
                  "type": "array",
                  "items": {"type": "string"}
                }
              }
            },
            "team": {
              "type": "object",
              "properties": {
                "size": {"type": "integer"},
                "expertise_level": {
                  "type": "string",
                  "enum": ["junior", "intermediate", "senior", "mixed"]
                },
                "skills": {
                  "type": "array",
                  "items": {"type": "string"}
                }
              }
            },
            "timeline": {
              "type": "object",
              "properties": {
                "start_date": {"type": "string", "format": "date"},
                "end_date": {"type": "string", "format": "date"},
                "milestones": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "name": {"type": "string"},
                      "date": {"type": "string", "format": "date"}
                    }
                  }
                }
              }
            },
            "budget": {
              "type": "object",
              "properties": {
                "total": {"type": "number"},
                "currency": {"type": "string"},
                "breakdown": {
                  "type": "object",
                  "properties": {
                    "development": {"type": "number"},
                    "infrastructure": {"type": "number"},
                    "licenses": {"type": "number"},
                    "maintenance": {"type": "number"}
                  }
                }
              }
            },
            "existing_systems": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "name": {"type": "string"},
                  "type": {"type": "string"},
                  "integration_points": {
                    "type": "array",
                    "items": {"type": "string"}
                  }
                }
              }
            }
          }
        }
      }
    },
    
    "response": {
      "type": "object",
      "required": ["architecture", "components", "rationale"],
      "properties": {
        "architecture": {
          "type": "object",
          "required": ["pattern", "description", "layers"],
          "properties": {
            "pattern": {
              "type": "string",
              "enum": ["microservices", "monolithic", "serverless", "event-driven", "layered", "hexagonal", "service-oriented", "hybrid"]
            },
            "description": {"type": "string"},
            "diagram_url": {"type": "string", "format": "uri"},
            "layers": {
              "type": "array",
              "items": {
                "type": "object",
                "required": ["name", "responsibility", "technologies"],
                "properties": {
                  "name": {"type": "string"},
                  "responsibility": {"type": "string"},
                  "technologies": {
                    "type": "array",
                    "items": {"type": "string"}
                  }
                }
              }
            }
          }
        },
        "components": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["id", "name", "type", "responsibility"],
            "properties": {
              "id": {"type": "string"},
              "name": {"type": "string"},
              "type": {
                "type": "string",
                "enum": ["service", "database", "cache", "queue", "gateway", "library", "external"]
              },
              "responsibility": {"type": "string"},
              "technologies": {
                "type": "array",
                "items": {"type": "string"}
              },
              "interfaces": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "name": {"type": "string"},
                    "type": {
                      "type": "string",
                      "enum": ["REST", "GraphQL", "gRPC", "WebSocket", "Message Queue", "Database"]
                    },
                    "protocol": {"type": "string"},
                    "format": {"type": "string"},
                    "authentication": {"type": "string"}
                  }
                }
              },
              "dependencies": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "component_id": {"type": "string"},
                    "type": {
                      "type": "string",
                      "enum": ["sync", "async", "optional"]
                    },
                    "purpose": {"type": "string"}
                  }
                }
              },
              "scaling": {
                "type": "object",
                "properties": {
                  "strategy": {
                    "type": "string",
                    "enum": ["horizontal", "vertical", "both", "none"]
                  },
                  "min_instances": {"type": "integer"},
                  "max_instances": {"type": "integer"},
                  "auto_scaling_rules": {
                    "type": "array",
                    "items": {"type": "string"}
                  }
                }
              }
            }
          }
        },
        "rationale": {
          "type": "object",
          "required": ["decisions", "trade_offs"],
          "properties": {
            "decisions": {
              "type": "array",
              "items": {
                "type": "object",
                "required": ["decision", "reasoning"],
                "properties": {
                  "decision": {"type": "string"},
                  "reasoning": {"type": "string"},
                  "alternatives_considered": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "option": {"type": "string"},
                        "pros": {"type": "array", "items": {"type": "string"}},
                        "cons": {"type": "array", "items": {"type": "string"}},
                        "rejection_reason": {"type": "string"}
                      }
                    }
                  }
                }
              }
            },
            "trade_offs": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "aspect": {"type": "string"},
                  "gained": {"type": "string"},
                  "sacrificed": {"type": "string"},
                  "justification": {"type": "string"}
                }
              }
            },
            "risks": {
              "type": "array",
              "items": {
                "type": "object",
                "required": ["risk", "probability", "impact", "mitigation"],
                "properties": {
                  "risk": {"type": "string"},
                  "probability": {
                    "type": "string",
                    "enum": ["low", "medium", "high"]
                  },
                  "impact": {
                    "type": "string",
                    "enum": ["low", "medium", "high", "critical"]
                  },
                  "mitigation": {"type": "string"},
                  "contingency": {"type": "string"},
                  "owner": {"type": "string"}
                }
              }
            }
          }
        },
        "implementation_plan": {
          "type": "object",
          "properties": {
            "phases": {
              "type": "array",
              "items": {
                "type": "object",
                "required": ["phase_number", "name", "duration", "deliverables"],
                "properties": {
                  "phase_number": {"type": "integer"},
                  "name": {"type": "string"},
                  "duration": {"type": "string"},
                  "deliverables": {
                    "type": "array",
                    "items": {"type": "string"}
                  },
                  "dependencies": {
                    "type": "array",
                    "items": {"type": "string"}
                  },
                  "success_criteria": {
                    "type": "array",
                    "items": {"type": "string"}
                  }
                }
              }
            },
            "critical_path": {
              "type": "array",
              "items": {"type": "string"}
            },
            "resource_allocation": {
              "type": "object",
              "properties": {
                "developers": {"type": "integer"},
                "architects": {"type": "integer"},
                "devops": {"type": "integer"},
                "qa": {"type": "integer"}
              }
            }
          }
        },
        "quality_attributes": {
          "type": "object",
          "properties": {
            "performance": {
              "type": "object",
              "properties": {
                "response_time": {"type": "string"},
                "throughput": {"type": "string"},
                "resource_usage": {"type": "string"}
              }
            },
            "security": {
              "type": "object",
              "properties": {
                "authentication": {"type": "string"},
                "authorization": {"type": "string"},
                "encryption": {"type": "string"},
                "compliance": {
                  "type": "array",
                  "items": {"type": "string"}
                }
              }
            },
            "scalability": {
              "type": "object",
              "properties": {
                "horizontal": {"type": "string"},
                "vertical": {"type": "string"},
                "geographic": {"type": "string"}
              }
            },
            "maintainability": {
              "type": "object",
              "properties": {
                "modularity": {"type": "string"},
                "testability": {"type": "string"},
                "documentation": {"type": "string"}
              }
            }
          }
        }
      }
    }
  }
}
{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Assembly Agent Schema - Editor-in-Chief",
  "description": "The editor-in-chief agent that aggregates, synthesizes, validates, and delivers the final output from all agents",
  "type": "object",
  "properties": {
    "metadata": {
      "type": "object",
      "properties": {
        "agent_type": { "const": "assembly_agent" },
        "role": { "const": "editor_in_chief" },
        "version": { "type": "string", "default": "2.0.0" },
        "timestamp": { "type": "string", "format": "date-time" },
        "task_id": { "type": "string" },
        "project_id": { "type": "string" },
        "assembly_run_id": { "type": "string", "format": "uuid" },
        "pipeline_status": {
          "enum": ["collecting", "validating", "synthesizing", "reviewing", "finalizing", "complete", "error"]
        }
      },
      "required": ["agent_type", "role", "version", "timestamp", "task_id", "assembly_run_id", "pipeline_status"]
    },

    "editorial_capabilities": {
      "type": "object",
      "description": "Core editorial capabilities of the editor-in-chief",
      "properties": {
        "content_synthesis": {
          "type": "object",
          "properties": {
            "merge_strategies": {
              "type": "array",
              "items": {
                "enum": ["union", "intersection", "weighted_average", "consensus", "priority_based", "intelligent_fusion"]
              }
            },
            "conflict_resolution": {
              "type": "object",
              "properties": {
                "primary_strategy": {
                  "enum": ["voting", "confidence_based", "source_priority", "human_review", "ai_arbitration"]
                },
                "fallback_strategies": {
                  "type": "array",
                  "items": { "type": "string" }
                },
                "resolution_rules": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "conflict_type": { "type": "string" },
                      "resolution_method": { "type": "string" },
                      "priority_order": { "type": "array", "items": { "type": "string" } }
                    }
                  }
                }
              }
            },
            "deduplication": {
              "type": "object",
              "properties": {
                "similarity_threshold": { "type": "number", "minimum": 0, "maximum": 1 },
                "merge_duplicates": { "type": "boolean" },
                "preserve_sources": { "type": "boolean" }
              }
            }
          }
        },
        
        "quality_control": {
          "type": "object",
          "properties": {
            "validation_checks": {
              "type": "object",
              "properties": {
                "coherence_check": { "type": "boolean", "default": true },
                "consistency_validation": { "type": "boolean", "default": true },
                "completeness_verification": { "type": "boolean", "default": true },
                "accuracy_assessment": { "type": "boolean", "default": true },
                "style_harmonization": { "type": "boolean", "default": true },
                "fact_checking": { "type": "boolean", "default": true },
                "citation_verification": { "type": "boolean", "default": true }
              }
            },
            "quality_gates": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "gate_name": { "type": "string" },
                  "threshold": { "type": "number" },
                  "action_on_failure": {
                    "enum": ["reject", "request_revision", "manual_review", "proceed_with_warning"]
                  }
                }
              }
            }
          }
        },

        "content_enrichment": {
          "type": "object",
          "properties": {
            "cross_referencing": { "type": "boolean" },
            "index_generation": { "type": "boolean" },
            "glossary_creation": { "type": "boolean" },
            "table_of_contents": { "type": "boolean" },
            "executive_summary_generation": { "type": "boolean" },
            "visualization_creation": { "type": "boolean" }
          }
        }
      }
    },

    "input_orchestration": {
      "type": "object",
      "description": "Orchestration of inputs from all agents",
      "properties": {
        "agent_inputs": {
          "type": "object",
          "properties": {
            "research_agent": {
              "type": "object",
              "properties": {
                "status": { "enum": ["pending", "received", "validated", "error"] },
                "findings": { "type": "array", "items": { "type": "object" } },
                "citations": { "type": "array", "items": { "type": "object" } },
                "confidence_scores": { "type": "object" },
                "market_analysis": { "type": "object" },
                "user_insights": { "type": "object" },
                "timestamp": { "type": "string", "format": "date-time" }
              }
            },
            "architect_agent": {
              "type": "object",
              "properties": {
                "status": { "enum": ["pending", "received", "validated", "error"] },
                "architecture": { "type": "object" },
                "components": { "type": "array", "items": { "type": "object" } },
                "data_flow": { "type": "object" },
                "tech_stack": { "type": "object" },
                "deployment_strategy": { "type": "object" },
                "timestamp": { "type": "string", "format": "date-time" }
              }
            },
            "ux_ui_agent": {
              "type": "object",
              "properties": {
                "status": { "enum": ["pending", "received", "validated", "error"] },
                "design_system": { "type": "object" },
                "wireframes": { "type": "array", "items": { "type": "object" } },
                "components": { "type": "array", "items": { "type": "object" } },
                "user_flows": { "type": "array", "items": { "type": "object" } },
                "brand_identity": { "type": "object" },
                "timestamp": { "type": "string", "format": "date-time" }
              }
            },
            "test_agent": {
              "type": "object",
              "properties": {
                "status": { "enum": ["pending", "received", "validated", "error"] },
                "test_results": { "type": "object" },
                "coverage_report": { "type": "object" },
                "performance_metrics": { "type": "object" },
                "security_report": { "type": "object" },
                "issues": { "type": "array", "items": { "type": "object" } },
                "timestamp": { "type": "string", "format": "date-time" }
              }
            }
          }
        },
        
        "collection_strategy": {
          "type": "object",
          "properties": {
            "timeout_ms": { "type": "integer", "default": 30000 },
            "retry_attempts": { "type": "integer", "default": 3 },
            "parallel_collection": { "type": "boolean", "default": true },
            "fallback_behavior": {
              "enum": ["use_cached", "proceed_partial", "fail", "request_human_input"]
            }
          }
        },

        "validation_pipeline": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "validator_name": { "type": "string" },
              "validator_type": {
                "enum": ["schema", "business_logic", "consistency", "completeness"]
              },
              "required": { "type": "boolean" },
              "error_handling": {
                "enum": ["reject", "auto_correct", "flag_for_review", "ignore"]
              }
            }
          }
        }
      }
    },

    "synthesis_engine": {
      "type": "object",
      "description": "Advanced synthesis and assembly engine",
      "properties": {
        "processing_stages": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "stage_name": { "type": "string" },
              "stage_order": { "type": "integer" },
              "operations": {
                "type": "array",
                "items": {
                  "enum": [
                    "data_normalization",
                    "deduplication",
                    "cross_reference_validation",
                    "fact_checking",
                    "coherence_analysis",
                    "gap_analysis",
                    "summarization",
                    "enhancement",
                    "visualization_generation",
                    "metadata_enrichment"
                  ]
                }
              },
              "parallel_execution": { "type": "boolean" },
              "checkpoint_enabled": { "type": "boolean" }
            }
          }
        },

        "intelligence_layer": {
          "type": "object",
          "properties": {
            "pattern_recognition": {
              "type": "object",
              "properties": {
                "identify_trends": { "type": "boolean" },
                "detect_anomalies": { "type": "boolean" },
                "find_correlations": { "type": "boolean" },
                "predict_outcomes": { "type": "boolean" }
              }
            },
            "insight_generation": {
              "type": "object",
              "properties": {
                "key_findings": { "type": "array", "items": { "type": "string" } },
                "recommendations": { "type": "array", "items": { "type": "object" } },
                "risk_assessment": { "type": "array", "items": { "type": "object" } },
                "opportunity_identification": { "type": "array", "items": { "type": "object" } }
              }
            },
            "context_enrichment": {
              "type": "object",
              "properties": {
                "historical_comparison": { "type": "boolean" },
                "industry_benchmarking": { "type": "boolean" },
                "best_practices_alignment": { "type": "boolean" },
                "regulatory_compliance_check": { "type": "boolean" }
              }
            }
          }
        },

        "narrative_construction": {
          "type": "object",
          "properties": {
            "storytelling_approach": {
              "enum": ["linear", "problem_solution", "chronological", "thematic", "comparative"]
            },
            "tone_and_style": {
              "type": "object",
              "properties": {
                "formality_level": { "enum": ["formal", "professional", "conversational", "casual"] },
                "technical_depth": { "enum": ["executive", "management", "technical", "expert"] },
                "language": { "type": "string", "default": "en" }
              }
            },
            "structure_optimization": {
              "type": "object",
              "properties": {
                "logical_flow": { "type": "boolean" },
                "progressive_disclosure": { "type": "boolean" },
                "pyramid_principle": { "type": "boolean" }
              }
            }
          }
        }
      }
    },

    "output_generation": {
      "type": "object",
      "description": "Final output generation and formatting",
      "properties": {
        "document_structure": {
          "type": "object",
          "properties": {
            "executive_layer": {
              "type": "object",
              "properties": {
                "executive_summary": { "type": "object" },
                "key_decisions": { "type": "array", "items": { "type": "object" } },
                "action_items": { "type": "array", "items": { "type": "object" } },
                "success_metrics": { "type": "array", "items": { "type": "object" } }
              }
            },
            "detailed_sections": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "section_id": { "type": "string" },
                  "title": { "type": "string" },
                  "content": { "type": "object" },
                  "contributing_agents": { "type": "array", "items": { "type": "string" } },
                  "confidence_level": { "type": "number", "minimum": 0, "maximum": 1 },
                  "supporting_evidence": { "type": "array", "items": { "type": "object" } }
                }
              }
            },
            "supporting_materials": {
              "type": "object",
              "properties": {
                "appendices": { "type": "array", "items": { "type": "object" } },
                "glossary": { "type": "object" },
                "references": { "type": "array", "items": { "type": "object" } },
                "data_tables": { "type": "array", "items": { "type": "object" } },
                "visualizations": { "type": "array", "items": { "type": "object" } }
              }
            }
          }
        },

        "format_options": {
          "type": "object",
          "properties": {
            "primary_format": {
              "enum": ["pdf", "html", "markdown", "docx", "confluence", "notion", "json"]
            },
            "alternative_formats": {
              "type": "array",
              "items": { "type": "string" }
            },
            "interactive_elements": {
              "type": "object",
              "properties": {
                "clickable_toc": { "type": "boolean" },
                "expandable_sections": { "type": "boolean" },
                "interactive_charts": { "type": "boolean" },
                "embedded_demos": { "type": "boolean" }
              }
            }
          }
        },

        "delivery_channels": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "channel_type": {
                "enum": ["email", "slack", "teams", "webhook", "api", "file_share", "repository"]
              },
              "configuration": { "type": "object" },
              "scheduling": {
                "type": "object",
                "properties": {
                  "immediate": { "type": "boolean" },
                  "scheduled_time": { "type": "string", "format": "date-time" },
                  "recurring": { "type": "boolean" },
                  "frequency": { "type": "string" }
                }
              }
            }
          }
        }
      }
    },

    "quality_assurance": {
      "type": "object",
      "description": "Quality metrics and validation",
      "properties": {
        "completeness_metrics": {
          "type": "object",
          "properties": {
            "required_sections_present": { "type": "boolean" },
            "agent_coverage": { "type": "number", "minimum": 0, "maximum": 1 },
            "data_completeness": { "type": "number", "minimum": 0, "maximum": 1 },
            "missing_elements": { "type": "array", "items": { "type": "string" } }
          }
        },
        "accuracy_metrics": {
          "type": "object",
          "properties": {
            "fact_verification_score": { "type": "number", "minimum": 0, "maximum": 1 },
            "citation_accuracy": { "type": "number", "minimum": 0, "maximum": 1 },
            "consistency_score": { "type": "number", "minimum": 0, "maximum": 1 },
            "validation_errors": { "type": "array", "items": { "type": "object" } }
          }
        },
        "readability_metrics": {
          "type": "object",
          "properties": {
            "flesch_reading_ease": { "type": "number" },
            "gunning_fog_index": { "type": "number" },
            "average_sentence_length": { "type": "number" },
            "technical_term_density": { "type": "number" }
          }
        },
        "performance_metrics": {
          "type": "object",
          "properties": {
            "assembly_time_ms": { "type": "integer" },
            "tokens_processed": { "type": "integer" },
            "operations_count": { "type": "integer" },
            "resource_utilization": { "type": "object" }
          }
        }
      }
    },

    "error_recovery": {
      "type": "object",
      "properties": {
        "error_handling_strategies": {
          "type": "object",
          "properties": {
            "missing_agent_data": {
              "type": "object",
              "properties": {
                "primary_action": {
                  "enum": ["use_default", "request_retry", "proceed_partial", "escalate"]
                },
                "fallback_actions": { "type": "array", "items": { "type": "string" } }
              }
            },
            "validation_failures": {
              "type": "object",
              "properties": {
                "auto_correction_enabled": { "type": "boolean" },
                "manual_review_threshold": { "type": "number" },
                "escalation_path": { "type": "array", "items": { "type": "string" } }
              }
            },
            "timeout_handling": {
              "type": "object",
              "properties": {
                "grace_period_ms": { "type": "integer" },
                "partial_results_acceptable": { "type": "boolean" },
                "cached_fallback": { "type": "boolean" }
              }
            }
          }
        },
        "audit_trail": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "timestamp": { "type": "string", "format": "date-time" },
              "event_type": { "type": "string" },
              "severity": { "enum": ["info", "warning", "error", "critical"] },
              "details": { "type": "object" },
              "resolution": { "type": "string" }
            }
          }
        }
      }
    },

    "human_oversight": {
      "type": "object",
      "description": "Human-in-the-loop capabilities",
      "properties": {
        "review_points": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "stage": { "type": "string" },
              "condition": { "type": "string" },
              "review_type": {
                "enum": ["approval", "editing", "validation", "decision"]
              },
              "timeout_action": {
                "enum": ["proceed", "wait", "use_default", "escalate"]
              }
            }
          }
        },
        "editorial_controls": {
          "type": "object",
          "properties": {
            "allow_content_editing": { "type": "boolean" },
            "track_changes": { "type": "boolean" },
            "version_control": { "type": "boolean" },
            "approval_workflow": { "type": "boolean" }
          }
        },
        "feedback_mechanism": {
          "type": "object",
          "properties": {
            "rating_system": { "type": "boolean" },
            "comments_enabled": { "type": "boolean" },
            "improvement_suggestions": { "type": "boolean" },
            "learning_loop": { "type": "boolean" }
          }
        }
      }
    },

    "integration_points": {
      "type": "object",
      "description": "External system integrations",
      "properties": {
        "project_management": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "platform": { "type": "string" },
              "capabilities": { "type": "array", "items": { "type": "string" } },
              "sync_enabled": { "type": "boolean" }
            }
          }
        },
        "documentation_platforms": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "platform": { "type": "string" },
              "auto_publish": { "type": "boolean" },
              "versioning": { "type": "boolean" }
            }
          }
        },
        "communication_channels": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "channel": { "type": "string" },
              "notification_types": { "type": "array", "items": { "type": "string" } },
              "priority_levels": { "type": "array", "items": { "type": "string" } }
            }
          }
        }
      }
    }
  },
  "required": ["metadata", "editorial_capabilities", "input_orchestration", "synthesis_engine", "output_generation", "quality_assurance"]
}